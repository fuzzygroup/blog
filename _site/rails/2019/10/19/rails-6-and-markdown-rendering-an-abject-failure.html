<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Rails 6 and Markdown Rendering - An Abject Personal Failure</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/blog/css/main.css">
  <link rel="canonical" href="http://fuzzyblog.io/blog/rails/2019/10/19/rails-6-and-markdown-rendering-an-abject-failure.html">
  <link rel="alternate" type="application/rss+xml" title="FuzzyBlog" href="http://fuzzyblog.io/blog/feed.xml">
  
  <!-- favicons -->
  <!-- shout out to: http://www.favicon-generator.org/ --> 
  <link rel="apple-touch-icon" sizes="57x57" href="/blog/assets/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/blog/assets/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/blog/assets/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/blog/assets/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/blog/assets/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/blog/assets/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/blog/assets/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/blog/assets/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/blog/assets/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/blog/assets/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/favicon-16x16.png">
  <link rel="manifest" href="/blog/assets/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/blog/assets/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <!-- end_favicons -->
  
  <!-- twitter specific head tags -->
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@fuzzygroup">
  <meta name="twitter:creator" content="@fuzzygroup">
  <meta name="twitter:title" content="Rails 6 and Markdown Rendering - An Abject Personal Failure">

  
    <meta name="twitter:description"
      content="

Note: I am not bitching here about the quality of Rails, High Voltage or any of the Markdown gems.  This is all open source software and I am delighted to have the abundance of free tools availab...">
  

  
    <meta name="twitter:image"
      content="http://fuzzyblog.io/blog/assets/scott_johnson.jpg">
  
  
  
  
  
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-83931583-1', 'auto');
    ga('send', 'pageview');

  </script>
  
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/blog/">FuzzyBlog</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/blog/about/">About</a>
          
        
          
          <a class="page-link" href="/blog/aws.html">AWS</a>
          
        
          
          <a class="page-link" href="/blog/category.html">Category</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/blog/resume.html">Resume for J. Scott Johnson</a>
          
        
          
          <a class="page-link" href="/blog/tag.html">Tag</a>
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div style="width: 70%; float:left; ">
            <p style="text-align: center; padding: 10px; border: 2px dashed red">
              <a href="https://www.jobhound.io/" class="cta-button-blue">My new product is Job Hound: Make applying for tech jobs suck less!</a>
            </p>
        </div>
        <!--
        <div style="width: 75%; float:left; ">&nbsp;&nbsp;&nbsp;</div>
        -->
          <!--
        <div style="width: 20%; float:right; ">
            <p style="text-align: center; padding: 10px; border: 2px dashed #000">
              <a href="http://www.fuzzyblog.io/" class="cta-button-blue">Hire Me!</a>
            </p>
        </div>
            -->
        <div style="clear: both;"></div>
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Rails 6 and Markdown Rendering - An Abject Personal Failure</h1>
    <p class="I'll"><time datetime="2019-10-19T00:00:00-04:00" itemprop="datePublished">Oct 19, 2019</time> 
      </p> 
  </header>
  

  <div class="post-content" itemprop="articleBody">
    <p class="center"><img src="/blog/assets/IMG_9517.jpeg" alt="IMG_9517.jpeg" /></p>

<p><strong>Note</strong>: I am not bitching here about the quality of Rails, High Voltage or any of the Markdown gems.  This is all open source software and I am delighted to have the abundance of free tools available to me.  And, trust me, I know that when people bitch, they should put on their big boy pants and contribute a pull request back to fix things.  And, if I had been capable of fixing this, I would have.  Alas I failed at fixing this.</p>

<p>Since I am a software engineer, I am experienced at failure.  One of the absolutely soul diminishing aspects of being a software engineer that none of us talk about is that we <strong>fail</strong>.  We fail <strong>a lot</strong>.  Last night, for example, I spent about four hours in engaged in a soul crushing battle to get the High Voltage gem to work with Rails 6.</p>

<p>The <a href="https://github.com/thoughtbot/high_voltage">High Voltage gem</a> is a gem that lets you put a series of pages like about, support, faq, etc in a directory and it injects into your application a “pseudo controller” that handles the display.  And then, if you aren’t running Rails 6, you can add a markdown gem like <a href="https://github.com/chrisroberts/kramdown-rails">kramdown-rails</a> and then have a directory of files like about.md, faq.md and have these be part of your application.  High voltage, along with a markdown gem, makes static pages an absolute delight.</p>

<p>And then came Rails 6.  I put an alpha release of a side project live last night and my buddy <a href="https://nickjanetakis.com/blog/">Nick Janetakis</a> helpfully clicked on the Faq link only to get a 500 error.  “Oh yeah I commented, I’ve got an <a href="https://github.com/thoughtbot/high_voltage/issues/289">issue</a> open on this”.  I checked the issue and even tho I reported it 24 days ago, it was lying fallow.</p>

<p>I figured, well, it is 2:30 in the morning and I had a craptacular night, why not dig into a complicated technical issue?  I mean how hard can this be – it is just a pseudo controller, right?  Well that was the beginning of a multiple hour session of low level gem debugging complete with a full round of Tourette’s style cursing that I’m not real proud of but at least no one else was around.</p>

<p>Here are the branch names I created during this fiasco:</p>

<ul>
  <li>markdown_bullshit_fucking_waste_of_time</li>
  <li>294-anti-markdown</li>
  <li>295-fuck-markdown-again</li>
</ul>

<p>And here are some of the github issues I made:</p>

<ul>
  <li>295-fuck-markdown-again</li>
  <li>throw out fucking markdown insanity and rewrite pages into html erb</li>
</ul>

<p>And I’d like to point out that no matter how pissed I got, I still followed good engineering practices:</p>

<ul>
  <li>all code was always in a branch so I could always revert</li>
  <li>issues were created</li>
  <li>pull requests were used</li>
</ul>

<p>Good engineering practices, when truly ingrained, when they are <strong>habits</strong>, carry you through bad experiences.  Thank you Sean Kennedy for beating this into my head.  Appreciated.</p>

<h1 id="things-i-learned-debugging-and-otherwise">Things I Learned, Debugging and Otherwise</h1>

<p>Here are some of the things I learned:</p>

<p>When you are doing gem debugging on osx and using TextMate, it is really, really helpful to open the gem in question with:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>bundle show high_voltage
mate /Users/sjohnson/.rvm/gems/ruby-2.6.3/gems/high_voltage-3.1.2 
</code></pre>
</div>

<p>This one, admittedly, I knew already but I always forget it when debugging gems.  This opens the gem in a TextMate window with the full file tree of the gem available so you can add byebug calls freely.</p>

<p>After you add a byebug call to a gem, you <strong>have</strong> to start and stop the development server.</p>

<p>Not a one of the different markdown gems or techniques worked:</p>

<ul>
  <li><a href="https://github.com/chrisroberts/kramdown-rails">https://github.com/chrisroberts/kramdown-rails</a></li>
  <li><a href="https://github.com/vmg/redcarpet">https://github.com/vmg/redcarpet</a></li>
  <li><a href="https://github.com/ytbryan/emd">https://github.com/ytbryan/emd</a></li>
  <li><a href="https://bloggie.io/@kinopyo/rails-render-markdown-views-and-partials">https://bloggie.io/@kinopyo/rails-render-markdown-views-and-partials</a></li>
  <li><a href="https://stackoverflow.com/questions/4163560/how-can-i-automatically-render-partials-using-markdown-in-rails-3/10131299#10131299">https://stackoverflow.com/questions/4163560/how-can-i-automatically-render-partials-using-markdown-in-rails-3/10131299#10131299</a></li>
  <li><a href="https://stackoverflow.com/questions/56715152/using-erb-in-markdown-with-redcarpet">https://stackoverflow.com/questions/56715152/using-erb-in-markdown-with-redcarpet</a></li>
</ul>

<p>Rails 6 changed the render template call from 1 parameter to two parameter and I suspect that’s at the heart of this.</p>

<p>And there were a few other things I tried.  I got fairly close at the end but I kept getting Markdown issues and, ultimately, I felt it was wiser to just, well, <strong>stop</strong>.</p>

<h1 id="my-final-solution">My Final Solution</h1>

<p>I ended up using the techniques that <a href="https://blog.teamtreehouse.com/static-pages-ruby-rails">teamtreehouse</a> advocated which amounted to:</p>

<ul>
  <li>A simple pages controller</li>
  <li>A cool routing trick</li>
</ul>

<p>And to make it easier for me, I added a dynamic index template which handles giving me a list of all static pages so I can easily review them. This was a dead simple (and mildy crappy) view but at this point I was about dead on my feet and I just wanted it done.  Here’s the view syntax:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="no">Index</span><span class="o">&lt;</span><span class="sr">/h1&gt;
&lt;ul&gt;
  &lt;% Dir.entries(File.join(Rails.root, "app/</span><span class="n">views</span><span class="o">/</span><span class="n">pages</span><span class="s2">")).sort.each do |file| %&gt;
    &lt;% next if file =~ /^_/%&gt;
    &lt;% next if file == 'index.html.erb'%&gt;
    &lt;% next if file == '.'%&gt;
    &lt;% next if file == '..'%&gt;
    &lt;% filename = File.basename(file, "</span><span class="p">.</span><span class="nf">html</span><span class="p">.</span><span class="nf">erb</span><span class="s2">")%&gt;
    &lt;li&gt;&lt;%=link_to(filename, "</span><span class="o">/</span><span class="n">pages</span><span class="o">/</span><span class="c1">#{filename}")%&gt;</span>
  <span class="o">&lt;</span><span class="sx">% end </span><span class="o">%&gt;</span>
<span class="o">&lt;</span><span class="sr">/ul&gt;
</span></code></pre>
</div>

<p>This could obviously be quite a bit better but this is one of those features that you write solely for yourself.  It isn’t linked to from anywhere on the site and the only one using it should be me or people on the project.</p>

<h1 id="conclusion">Conclusion</h1>

<p>If you do this stuff long enough, you are bound to fail at things.  I mean a software engineer’s entire day basically amounts to “try stuff over and over and stop when it starts working”. And, if you are lucky, then you get to take the time to make it better and maybe improve it.  An embarrassingly large amount of the time that first working bit gets shipped.</p>

  </div>
  
  <!--
    http://fuzzyblog.io/blog/tag.html#aws
    http://localhost:5000/blog/category.html#facebook
  -->
  
  <hr/><br/>
  <p><strong>Posted In:</strong>
  
    <a href="http://fuzzyblog.io/blog/tag.html#rails" >
      #rails
    </a>
    
  </p>
  
  <!--
  <hr/><br/>
  <div style="text-align: center;">
      <ul class="list-inline tags" >       
     
     <li style="display: inline-block;">
       <a href="http://fuzzyblog.io/blog/tag.html#rails" class="link_button">
         rails
       </a>
     </li>
     
    </ul>

  </div>
-->  


  
  
  

</article>

<div class="just-comments" data-apikey="2fb5b93f-dad4-41c0-a9c4-645079ddc541"></div>
<script async src="https://just-comments.com/w.js"></script>


      </div>
    </div>

    <div class="wrapper">
  <div style="">
    <!--
    <p style="text-align: center; padding: 10px; border: 2px dashed #000">
      <a href="https://www.gamenanny.io/" class="cta-button-blue">My new product is Game Nanny: Never be surprised by your kid's Xbox spending again!</a>
    </p>
      -->
      <p style="text-align: center; padding: 10px; border: 2px dashed red">
        <a href="https://www.jobhound.io/" class="cta-button-blue">My new product is Job Hound: Make applying for tech jobs suck less!</a>
      </p>
      
  </div>
</div>

<footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">FuzzyBlog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>FuzzyBlog</li>
          <li><a href="mailto:fuzzygroup@gmail.com">fuzzygroup@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/fuzzygroup"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">fuzzygroup</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/fuzzygroup"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">fuzzygroup</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Scott Johnson writing about the usual array of nerd stuff: AWS / Ansible / Ruby / Rails / Elixir / Misc / Hyde.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>

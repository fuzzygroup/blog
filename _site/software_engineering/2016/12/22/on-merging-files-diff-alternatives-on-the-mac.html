<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>On Merging Files - Diff Alternatives on the Mac</title>
  <meta name="description" content="There are certain skills as a software developer that take, in my experience, a lifetime to master.  I have now been using version control since the mid 1990...">

  <link rel="stylesheet" href="/blog/css/main.css">
  <link rel="canonical" href="https://fuzzyblog.io//blog/software_engineering/2016/12/22/on-merging-files-diff-alternatives-on-the-mac.html">
  <link rel="alternate" type="application/rss+xml" title="FuzzyBlog" href="https://fuzzyblog.io//blog/feed.xml">
  
  <!-- twitter specific head tags -->
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@fuzzygroup">
  <meta name="twitter:creator" content="@fuzzygroup">
  <meta name="twitter:title" content="On Merging Files - Diff Alternatives on the Mac">

  
    <meta name="twitter:description"
      content="There are certain skills as a software developer that take, in my experience, a lifetime to master.  I have now been using version control since the mid 1990s and I still don’t consider myself, by ...">
  

  
    <meta name="twitter:image"
      content="https://fuzzyblog.io/blog/assets/scott_johnson.jpg">
  
  
  
  
  
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-83931583-1', 'auto');
    ga('send', 'pageview');

  </script>
  
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/blog/">FuzzyBlog</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/blog/about/">About</a>
          
        
          
          <a class="page-link" href="/blog/aws.html">AWS</a>
          
        
          
          <a class="page-link" href="/blog/category.html">Category</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="/blog/resume.html">Resume for J. Scott Johnson</a>
          
        
          
          <a class="page-link" href="/blog/tag.html">Tag</a>
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">On Merging Files - Diff Alternatives on the Mac</h1>
    <p class="I'll"><time datetime="2016-12-22T11:26:49-05:00" itemprop="datePublished">Dec 22, 2016</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>There are certain skills as a software developer that take, in my experience, a lifetime to master.  I have now been using version control since the mid 1990s and I still don’t consider myself, by any means, a master.  I’m good, don’t get me wrong, but I don’t feel that I have yet fully internalized all the benefits that version control offers.  So, when I have a chance to really take advantage of version control, I truly relish the opportunity.</p>

<p>I recently had a refactoring situtation where I was, shall we say, overly ambitious.  And, yes, that’s the positive version of what I’d refer to as “Humpty Dumpty” code syndrome where you have so thoroughly broken a critical bit of code that you just can’t put it back together.  Specifically:</p>

<ul>
  <li>I refactored a truly alway bit of two critical routines, one with 8 input variables that returned 6 variables</li>
  <li>No test coverage</li>
  <li>It would not, no matter what I did, do what it did before; specifically it would do the first pass of an N pass algorithm but I could never make it go beyond stage 1</li>
  <li>In the process of doing this I added new and highly desirable functionality everywhere and fixed about 30 critical code mistakes along the way</li>
</ul>

<p>So, well, <strong>crap</strong>.  The fix was, in the immortal words of Doctor Who, to get all timey-whimey!  Specifically I needed to time travel back to <em>before</em> I started and then:</p>

<ul>
  <li>confirm that this code actually worked in the first place – maybe this problem existed before I <em>fixed</em> it</li>
  <li>figure out how to travel back from the past while bringing with me a working version</li>
  <li>NOT lose any of the cool new features</li>
</ul>

<p>One of the development practices I am absolutely adamant about is only ever having 1 checkout of the code based at a time.  I’m hardcore on this because I’ve seen what happens when you have multiple versions floating about – its very, very convenient but you tend to get confused and then you lose track of what’s the master and things get screwball.  But, in desparate times, you do what you must and so I went over to github and:</p>

<ul>
  <li>I found a commit from roughly before I started; I wasn’t real specific about this, I just remember “this debacle started last Thursday so goto Wednesday”</li>
  <li>I browsed the code base at that point</li>
  <li>I created a new directory where I wanted this</li>
  <li>I checked out the code; that put a fresh copy of master in place</li>
  <li>I did a git co HASH where HASH represented the commit hash for Wednesday</li>
</ul>

<p>This put me what’s called <a href="http://stackoverflow.com/questions/3965676/why-did-my-git-repo-enter-a-detached-head-state"><em>detached head</em></a> mode and I was able to modify /run / test, etc.  I then had to:</p>

<ul>
  <li>port over my rake task which was doing my tests</li>
  <li>port over the individual changes, one by one, <em>carefully</em> to let the old code run correctly</li>
</ul>

<p>What I found was that the old code did, in fact, run better than the new code.  Sigh.  And after 2 days of fixing things all over the place I had the system back to running order with the exception that I now had 2 code bases that needed to be merged.  <em>Bigger Sigh</em>.</p>

<h1 id="time-for-some-diff-magic">Time for some Diff Magic</h1>

<p>So I now had two git checkouts with differences between them.  One of them was master, and did I mention that while this was all going on I got pulled off the project to fix something else and add yet more functionality to the code base for a day and half, and the other was my time travel branch.  When I did a git status in the time travel branch I got this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git status
HEAD detached at 93bf221
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

	modified:   app/models/form.rb
	modified:   app/models/form2016_q4.rb
	modified:   app/models/iframe2016_q4.rb
	modified:   app/models/link.rb
	modified:   app/models/link2016_q4.rb
	modified:   app/models/page.rb
	modified:   app/models/page2016_q4.rb
	modified:   app/models/page_body.rb
	modified:   app/models/page_body2016_q4.rb
	modified:   app/models/site.rb
	modified:   app/models/unique_url.rb
	modified:   app/models/unique_url2016_q4.rb
	modified:   app/models/url_resolver.rb
	modified:   app/models/url_tool.rb
	modified:   config/initializers/constants.rb
	modified:   lib/common_link.rb
	modified:   lib/common_page.rb

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)

	docs/snippets/create_mechanize_page_without_fetch.rb
	lib/tasks/crawl2016_q4.rake

no changes added to commit (use "git add" and/or "git commit -a")
</code></pre>
</div>

<p>That’s a whole lot of changes.  The easiest approach was to start with the entirely new files and just copy them over to the original.</p>

<p>Now this is where I’m going to make a highly personal engineering choice here – I’m going to avoid an automated merge process of any type.  When it comes to complex code changes in an automated fashion I honestly don’t have a lot of faith.  I’ve seen automated merges go wrong time after time so I was looking for a tool to make this easier.  A quick bit of googling turned up:</p>

<ul>
  <li>OpenDiff / FileMerge (part of X-Code)</li>
  <li><a href="http://meldmerge.org/">meld</a> - a python tool with an unofficial brew install via <em>brew install homebrew/gui/meld</em></li>
  <li>[Beyond Compare]http://www.scootersoftware.com/download.php from <a href="http://www.scootersoftware.com/">Scooter Software</a></li>
  <li><a href="http://www.sourcegear.com/diffmerge/">Diff Merge</a> from <a href="http://www.sourcegear.com/">SourceGear</a></li>
  <li><a href="http://www.kaleidoscopeapp.com/">Kaleidoscope</a></li>
</ul>

<p>I ended up using Open Diff for my merge issues:</p>

<p><img src="/blog/assets/open_diff.png" alt="opendiff" /></p>

<p>diff_merge.png
beyond_compare.png
kaleidoscope.png</p>

<p>Good articles on merge tools:</p>

<ul>
  <li><a href="https://www.git-tower.com/blog/diff-tools-mac">GitTower</a></li>
  <li><a href="https://www.outcoldman.com/en/archive/2014/05/12/git-dirdiff/">outcoldman</a></li>
  <li></li>
</ul>

  </div>
  
  

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">FuzzyBlog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>FuzzyBlog</li>
          <li><a href="mailto:fuzzygroup@gmail.com">fuzzygroup@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/fuzzygroup"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">fuzzygroup</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/fuzzygroup"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">fuzzygroup</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Scott Johnson writing about the usual array of nerd stuff: AWS / Ansible / Ruby / Rails / Elixir / Misc / Hyde.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
